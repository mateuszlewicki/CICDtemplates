parameters:
  - name: virtualenvName
    type: string
    default: 'pyrelease'
  - name: requirements
    type: string
    default: |
     datetime==4.3
     requests==2.26.0
     veracode-api-signing==21.3.0
     zope.interface==5.4.0
     pytz==2021.1
     urllib3==1.26.7
     charset-normalizer==2.0.6
     certifi==2021.5.30
     idna==3.2
     docopt==0.6.2
     httpie==1.0.3
     Pygments==2.10.0
     setuptools==58.1.0

steps:
  # CREATE VIRTUAL ENV
  # INSTALL necessary package
  # CREATE virtual env in parameters.virtualenvName
  # IF there are requirements CREATE requiremetns.txt via convertToFile helper
  # THEN install requirements
  # AFTER installation remove requirements.txt
  - template: /templates/common/use-python-version.yaml
  - script: |
      python -m pip install virtualenv
      python -m virtualenv ${{ parameters.virtualenvName}}
    displayName: "Create Python Virtual Environment in ${{ parameters.virtualenvName}}"
  - ${{ if parameters.requirements }}:
    - template: helpers/convertToFile.yaml
      parameters:
        fileName: "requirements.txt"
        fileContent: "${{ parameters.requirements }}"
        displayName: "Create requirements.txt"
    - template: PipCommand.yaml
      parameters:
        command: pip install -r requirements.txt
        virtualenvName: "${{ parameters.virtualenvName}}"
        displayName: "Install requirements"
    - template: helpers/removeFiles.yaml


